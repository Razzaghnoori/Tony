                    Background        For the development of an allencompassing potential        energy function for the protein folding problem that can        simulate both the thermodynamic and kinetic processes it        is argued that one must start from first principles            However given the complexity of the problem involving        thousands of atoms and an extremely large number of        conformations available to these atoms the available        computational power posses a serious restriction        Alternatively one could use the available experimental        results to develop empirical potential functions using a        simplified representation for the system which does not        require an explicit enumeration of the entire system Here        we present one such simplified method to train a potential        energy function using a small set of proteins which places        a significant number of additional native conformations        near its minima        Ideally we would like to obtain a potential energy        function which assigns correct free energy to the native        and nonnative states for all the proteins However this        requires knowing the complete distribution of energy states        and total number of degeneracies for both the native and        denatured states quantities which are not readily        available even for a simplified representation of our        system This has led to design of potential functions with        restricted objectives        Knowledgebased potentials are obtained from a survey of        protein crystal structures In this case there is no        training of parameters The residueresidue interaction can        be defined as contact vs nocontact type      or        alternatively can also be defined as distance dependent              The resulting potentials depend upon the training        set of proteins reference state and the functional form            Thomas and Dill     have pointed out that these        potential functions do not assign the correct value to the        energy parameters though they do rank them correctly        On the other hand the potential parameters are        explicitly trained in the optimizationbased methods In        these cases the goal is to obtain a potential function        which either maximizes the difference between the native        and average nonnative state energy Zscore            maximizes the ratio of folding to glass transition        temperatures    or requires that all the nonnatives be        of energy higher than the native     Here the native        state is represented by a single conformation While the        first two approaches provide reasonable results they do        not guarantee complete success in terms of fold recognition        even for the training set proteins A somewhat better        criterion is to require that all the nonnative        conformations have energy higher than the native In this        case if the energy function is chosen such that the total        energy of the conformation is a linear function of its        adjustable parameters then the problem can be stated as a        linear programming problem with a suitable objective        function                   There are five factors that govern the training of a        potential function using optimizationbased methods i        representation of amino acids ii choice of the        interaction energy function iii training set of        proteins iv generation of the alternative conformations        or decoys and v the objective function        The representation of the amino acids depends upon the        amount of atomiclevel detail one wishes to incorporate in        the calculations starting from a single point per residue        representation      to an allheavy atom        representation      As more and more details are        included the complexity of the calculations increases        however a coarsegrained model can not be expected to        produce very refined structure predictions While the        lattice models have usually stayed with single point        representation the continuous state models have used        different variations from a single point per residue to        allatom representation        The choice of the interaction energy function to some        extent depends upon the physical property of the amino acid        which is deemed important as well as on the type of amino        acid representation used The most commonly used pairwise        interresidue interactions can be treated as contactno        contact       discrete distance ranges              and continuously varying functions of distance                The energy function should be flexible enough        without causing overfitting While having more parameters        does provide the flexibility having too many of them is        not always helpful as seen by Park et al    where a         parameter potential performed worse than a simple        contact type function Such discontinuous functions could        also lead to problems if used for kinetic calculations or        for local optimization Furthermore it has been shown that        distance dependent energy functions perform better than        contact type in a continuous conformation space                   Furthermore excludedvolume effects play an important        role in the performance of a potential function As Thomas         Dill    have pointed out one of the reasons for        failure of the potential functions is the absence of any        excludedvolume effects in the interaction energy models        Similarly Park  Levitt    show that a van der        Waals type energy function gives better results than        contact type or solvation potential alone and a        combination of surface energy function with a van der Waals        type energy function performs even better        Another crucial requirement for the development of        potential functions using optimizationbased methods is the        generation of realistic and challenging decoys A great        deal depends upon the set of decoys used to define the        nonnative state It has been demonstrated by various        investigators      that using a set of decoys        obtained mostly by threading does not enforce a very        stringent training criterion and the potential functions        so obtained fail to even place the training set native        conformations near a local minimum let alone the global        minimum Similarly one can obtain low energy conformations        by manipulation of conformations in a contact map        representation though this may lead to geometrically        unrealizable conformations     Other methods which        have been used to generate low energy decoys include        MonteCarlo simulations    and molecular dynamics        simulations      both of which require significant        computation time discretization of conformational        variables     and inclusion of rigid pieces of        structures            A necessary though not sufficient condition for a well        behaved potential function is that the native conformation        be at or near a minimum of the potential function As        pointed out earlier       the potential functions        derived with mostly threaded conformations fail to satisfy        this condition even when a large set of conformations is        used The reason for such a failure is that the training        conformations are fixed and not allowed to relax given a        potential function This results in most of the        conformations being of significantly higher energy and only        a small set of conformations end up providing an active        constraint set However if the inactive conformations are        allowed to relax they would provide a much more stringent        set of constraints and will improve the performance of the        potential function significantly In this work we place a        milder condition on the training by only asking that the        native be near a local minimum No condition is placed for        the global minimum We use energy minimization to generate        new decoys which are physically realizable low energy        decoys and provide better training Furthermore a        physically meaningful objective function is used during the        quadratic programming Here we train a potential function        using only a few single domain monomeric proteins which do        not require any hetero groups or ligands to stabilize their        folded state These chains have less than  sequence        alignment using MOE     and significantly different        crystal structures average rmsd of   Once trained        the potential function is able to place  proteins even        including some multichain proteins and two CASP proteins        to within   of the experimental native conformations        Here we present a method that trains a reasonably good        potential function using only a few proteins                    Results and Discussion                  PIE function          The PIE function shown in Figure  has  parameters          per interaction type hence a total of  parameters          The potential function was so trained that when the          native conformations of the training set proteins are          energy minimized the resulting local minimum          conformation is within   rmsd For all choices of                      G   and                          cut              the potential was trainable ie the          potential function had enough flexibility that we did not          run in to a situation where the QP could not come up with          a solution though at times solutions were suboptimal          The performance of these potential functions on the test          set proteins varied greatly In general high           G and low                        cut            values resulted in a very rough energy surfaces          which led to large energy changes for small          conformational variations On the other hand low           G and high                        cut            values resulted in a potential function that is too           flat and allows easy conformational          changes For these proteins we found that a value of           G   and                        cut              gave us the best results This potential          function PIE is able to place four of the  test          protein native conformations to within   rmsd of a          local minimum see Table  The other eight are between            rmsd                          SE function          The SE function is very simple and has only           adjustable parameters one for each residue and one for          the overcrowding which prevents a complete collapse of          the chain as well as prevents any unrealistic chain          overlaps Once again we used the same three proteins and          used various combinations of           G and                        cut            to obtain solutions However this time with the SE          function by itself we failed to obtain a potential          function even for a single protein let alone all three          proteins together As soon as the conformations were          generated by energy minimization process we obtained a          set of inequalities which resulted in a null feasible          solution region for QP This shows that the SE function          by itself does not have enough flexibility to give a          trained potential function when decoys are generated by          more rigorous methods Yet this function was          successfully trained by threading using experimental          crystal structures                              PSE function          As with the PIE the same three proteins are used for          the training purposes Since this is a sum of the other          two energy functions there are  parameters the one          parameter for overcrowding in the SE function having been          removed since the           f            part of the PIE function performs a          similar function Once again we obtain various sets of          trained parameters depending upon the value of           G and                        cut             and once again we find that           G   and                        cut              give the best results for the test proteins          In this case PSE six of these proteins remain within            rmsd and all  are within   Considering that          the test set contains both close homologs and          significantly different proteins from the training          proteins in terms of their size sequence and structure          this is a very encouraging result since all  test          proteins remain within   compared to   for PIE It          shows that using a PSE function one can train a          potential function using only a few proteins which would          be applicable to many other proteins The comparison          between the results of the PIE and PSE functions is          shown in Table           The training for PSE was performed using three          proteins Set A  ayi bk ubi none of which          contains Cys However there were many other interactions          which remained untrained in the final version of PSE To          get all  pairwise interactions to train at least          moderately we had to either select larger proteins which          contain all residues in sufficient number or enlarge the          training set even if all the residues are not present in          any one of the protein Since computation time increases          as square of the chain length we chose to enlarge the          training set using smaller proteins A set of four          proteins Set B enh bk era ubi contains all          the  amino acids collectively However in the final          trained potential function PSE eight of the          interactions still remain completely untrained This set          was then further expanded by including two additional          proteins Set C enh bk era ubi ail dsl          The final trained potential function using Set C PSE          has all the pairwise interactions at least mildly          trained Set C contains two proteins enh and ail with          mostly helical structure three bk era and dsl          with mostly sheet structure and one ubi with           structure However there is very little sequence          identity between any of these proteins and their crystal          structures are also very different less than           sequence alignment and rmsd of   in their crystal          structures using MOE The corresponding solvation          parameters for various residues are shown in Table           The best results for Set B PSE are obtained using           G   and                        cut              The potential function PSE places  of the           test set native conformations to within   of a          local minimum see Table  which is a significant          improvement over PSE The PSE was further applied to          another  proteins see Table  for a total of  test          proteins Of these  test proteins  native          conformations were placed within   rmsd of a local          minimum including three CASP proteins and  are          within   rmsd Thus PSE places a total of  native          conformations including the training set proteins of          very different sequences and crystal structures to within            rmsd and  to within   rmsd of a local minimum out          of a total of  proteins The set of  proteins          contains a variety of proteins some of which are          multichain eg db or require a large group for          stabilization eg cc          The best result for Set C potential function PSE          with           G   and                        cut              places  out of  test set proteins to          within   rmsd see Table  In all out of           proteins including the training set  are within            and  are within   including two CASP proteins          The fact that PSE is able to place  out of  native          conformations within   rmsd of a local minimum for          proteins of very different sequences crystal structures          and length points to the robustness of the potential          function and therefore the usefulness of the          approach                          Threading test          To further test the validity and usefulness of the          final potential function PSE we performed an ungapped          threading test using all the  proteins We first energy          minimized each of the native conformations and obtained          the conformation of the local minimum using potential          PSE These local minimum conformations were then used as          decoys during ungapped threading tests for each protein          The threaded conformations were not energy minimized In          the threading test instead of the usual single point          representation for each residue we use a five point          representation for each residue since the potential PSE          has been trained using this representation Out of           proteins  native conformations are ranked first and          the other two dsl snc are ranked second This test          is conducted using a total of  decoys Therefore          we see that a potential function trained using the          procedure outlined in this work also performs well when          subjected to the threading test whereas the potentials          designed using only threaded conformations do not perform          well when decoys are generated using energy          minimization          One of the drawbacks of this procedure is that the          training process is not sequential and therefore quite          time consuming ie addition of inequalities for a new          protein after the training for one protein is complete          does not necessarily give better results Any change in          protein set           G                         cut            or any other strategy change requires starting all          over again since the set of conformations generated for          the training are based on the current set of parameters          ie the process is memory dependent However given          that the potential energy surface is of very high          dimension and highly irregular it is to be expected          By only considering the energy minimization of the          experimental native conformation we reduce the amount of          time required to train the potential function Each          potential function could be trained within a week running          on four Sun workstations CPU speeds  MHz MHz          However we had to perform many training runs to get the          best possible potential function for each set and at          this point it guarantees only the local minimum condition          for the native state not the global one                            Conclusions        A necessary though not sufficient condition for the        stability of the native state of a protein is that the        experimental native conformation be at or near a minimum of        the potential function We show that by using only a small        set of proteins potential functions can be trained that        put a large number of native states near a local minimum of        the potential function While this does not guarantee the        stability of the native state this does ensure that the        native conformation is not sitting at highly unstable        points on the potential surface a condition which is        encountered in other potential functions Our best        potential function PSE obtained using training Set C        containing six proteins is able to place a total of         native conformations to within   rmsd and  native        conformations to within   rmsd of a local minimum of the        potential function out of the  proteins We also find        that while the pairwise interaction energy function is        trainable using the more rigorously generated decoys the        solvation potential alone is not The solvation potential        has only  adjustable parameters and can not provide        enough flexibility to satisfy all the constraints in our        case though it was trainable using threaded conformations        from PDB The best results are obtained using the pairwise        energy function in combination with the solvation energy        function We further test the final potential function PSE        with threaded conformations for  proteins and find that         of the native conformations are ranked first and the        remaining two are ranked second The training process is        further improved by the use of a physically meaningful        quantity for the objective function in the QP optimization        which helps in identifying a better solution                    Methods                  Generation of native structure          For the purposes of training we select only single          domain monomeric proteins which do not require any          hetero atoms or ligands for their stabilization in the          folded state Furthermore the atom positions are          available for the main chain heavy atoms and at least the          corresponding C            atom of the residue The crystal          structures obtained from PDB     for the protein          chains are fitted to a standard geometry continuous state          model very similar to the one used by Dill           et al     In the fitted          model each side chain is represented by a single          interacting site located at the C             while keeping all the main chain          heavy atoms ie each residue is represented by five          interacting sites united atom types Standard values          for bond lengths and bond angles are used and all          peptide bonds are kept in the trans conformation Thus          only torsion angles   are allowed to vary between           and  The details of the fitting procedure are          described in ref  and will not be repeated here The          fitted model is within   rmsd    of the PDB          structure and is used as the native structure in our          calculations Thus the native state is a single energy          nondegenerate state in our calculations                          Generation of the nonnative decoys          The conformations of the nonnative decoys are          generated using the following procedures i          ParameterIndependent Decoys Starting from the native          conformation all pairs of torsional angles are perturbed          by      at a time For example for a chain of           residues there are  torsion angles and therefore           pairs of torsional angles This would give us           different decoys but see the Solution Procedure section          for the precise protocol used These conformations do not          depend upon the current potential function ii          ParameterDependent Decoys The native conformation is          energy minimized with respect to torsion angles using the          current potential function                          Energy functions          Since we generate conformations by energy minimization          with respect to the torsion angles which are allowed to          change continuously we also need an energy function that          is a continuous and differentiable function of angles We          use three different types of energy functions the          pairwise interaction energy PIE function the solvation          energy SE function and the pairwise interaction with          solvation energy PSE function In our case all these          functions are continuous functions of separation between          atoms and therefore the conformations can be energy          minimized with respect to torsion angles to generate          decoys once we use the standard geometric representation          for the conformations                          Pairwise interaction energy PIE function          The pairwise interaction between a pair of atoms is          represented by                       where           p           k           t           i t           j   are adjustable parameters                    t                       i            is the type of united atom           i and           x                       ij            is the distance between united atoms           i and           j  The function           f                       k                       x                       ij             is defined over a limited distance interval as          follows                    where           b             a                        a                        a              and           a              The first term in each          interaction           f                       x                       ij             provides some steric repulsion for atoms sitting          too close to each other and its coefficient is always          fixed at  which prevents a complete collapse of the          chain The other three functions have adjustable          coefficients which are allowed to vary between  and           The functional form of           f                       k                       x                       ij            s is shown in Figure  Each interaction energy is          represented by four parameters The maximum interaction          distance is   Equation  has following          properties                    e                       t                           i                                               t                           j                                               e                       t                           i                                               t                           j                                   x           ij    for           x                       ij                                  The interaction energy function           e                       t                           i                                               t                           j                                   x           ij  is continuous and          differentiable for all           x                       ij              and is a linear function of adjustable          parameters          Furthermore we consider  atom types  side chain          atom types representing  different amino acids and four          main chain heavy atoms C             C N and  This gives us a          total of      different types of interactions          and a total of  parameters In the present study           of these parameters have a fixed value of  and  are          adjustable The total pairwise energy is                    where the summation is over all pairs of united atom          types separated by at least three covalent bonds Since          the total pairwise energy of any conformation is just the          sum of individual pairwise interaction energies the          total pairwise energy is also a linear function of the          adjustable parameters                          Solvation energy SE function          The solvation energy represents the change in energy          due to the burial of various residues This is an average          contribution for each residue based upon how many other          residues are surrounding it and given by                    where           p                     k            i  is the energy contribution          for a residue of type           k at sequence position           i along the chain surrounded by          other residues and           P                       s            is the penalty for overcrowding Here the first          summation is over all residue pairs separated by at least          two residues along the chain backbone and second          summation is over all those residues for which the total          number of contacts exceeds the maximum allowable number          The number of excess contacts           S                       i            are                    The function           C                       t                           i                                               t                           j                                   x           ij  determines the burial of each          residue where           x                       ij            is the separation between two side chain C            atoms situated at positions           i and           j  These are sigmoidal functions          see Figure  Both           C                       t                           i                                               t                           j                                   x           ij  and           C                     k            i            max  were obtained by          Dombkowski and Crippen    from the survey of PDB          crystal structures and these functions are predetermined          in our training procedure Only the           p                     k            i  s and           P                       S            are determined here This energy function has          therefore only  adjustable parameters                          Pairwise interaction with solvation energy PSE          function          The PSE function includes both the pairwise          interaction energy and the solvation energy without the          overcrowding part since the           f                       x                       ij             part of the PIE function ensures that the chain          does not collapse to a point The total energy in this          case is given by                    and it has a total of  adjustable parameters                          Parameter adjustment using quadratic          programming          Given the above energy functions the total energy of          any conformation is a linear function of the adjustable          parameters irrespective of the energy function being          used This property allows us to use quadratic          programming QP to adjust the values of these          parameters We choose the following objective function          for the optimization purposes                    where                      n            k  is the sum of the          coefficients of the           N                       p            parameters           p                       k            when the derivative of the energy of a conformation          is evaluated at the native conformation of the           n th protein While the first term          minimizes the gradient of the energy with respect to          dihedral angles at the native conformation for all          training set proteins the second term keeps the values          of parameters small to reduce the roughness of the energy          surface Having a continuous energy function is essential          for using such a physically meaningful objective          function By minimizing the magnitude of the gradient of          energy of the native conformation we obtain a set of          parameters such that the native conformation approximates          a stationary point of the potential function The total          number of parameters           N                       P            depends upon the type of energy function is being          used namely  for the PIE function  for the SE          function and  for the PSE function The constraints          are of the form                     E            E                       non                       E                       nat                       g            where                    where           G and                        cut            are adjustable constants If                          cut             we consider the decoy to be conformationally          identical to the native and no inequality is generated          even if the energy of the decoy is lower than that of the          native The constants           G and                        cut            define the minimum energy separation between the          native and decoys and the radius of the basin of the          native respectively They may be changed from one          training run to another however not during the same          training run Here  is given by                       where           R                       gj            is the radius of gyration of the           j thconformation and           D            is the customary root mean square          deviation in C            coordinates after optimal          superposition of the two conformations taken to be the          native and an alternate By allowing           g to vary linearly with  near the          native structure we avoid sudden jumps in the potential          energy surface and keep the variation in the energy          function smooth near the native Finally we need to          provide bounds on our parameters and we have chosen           p                       k              for all           p                       k            s which multiply           f                       x                       ij            s and             p                       k              for the rest of them These values are chosen          so that we are able to find a feasible solution while          keeping most of the parameters away from the extreme          values Due to the choice of  we use quadratic          programming QP instead of linear programming to solve          the set of inequalities                             Solution procedure          We obtain the initial set of parameters by minimizing          using QP The decoys are generated using the methods          described earlier First the decoys are generated by          perturbing pairs of torsion angles by an amount  For a          chain of           n residues there are            n            n  such pairs Even for a          chain with  residues this would produce           conformations Initially since the parameter set is          completely untrained a large number of inequalities are          generated for a training set of three to six proteins          ranging in length from  residues To keep the number          of inequalities to a reasonable value we first perturb          pairs of angles separated by a certain number of covalent          bonds           n and its multiples For example          in the first pass we change the pair of angles separated          by           n   covalent bonds or multiples          of it ie    etc In this case starting from          the fifth torsion angle from the Nterminus we perturb          pairs of angles located at            k             l  positions along the chain where                    k            l               etc collect all the inequalities          and run them through the QP to obtain a new set of          parameters Next we take pairs of angles separated by           backbone bonds and add new inequalities to the previous          set and obtain a new set of parameters by QP This          process is repeated for pairs of angles separated by two          one and zero backbone bonds Next we repeat this process          for all pairs of angles by perturbing them by                and    where      This is the          parameter independent generation of decoys          The next step is parameter dependent generation of          decoys Here we use energy minimization of native          conformation using           BFGS method     to generate          new decoys During each cycle we begin from the native          conformation and energy minimize the conformations with          respect to the torsion angles After every           minimization steps the conformational distance of the          current conformation from the native is calculated in          terms of  If the  value is greater than the cutoff          value            cut  we say that the current          conformation is sufficiently different from the native          one ie it does not belong to the basin of native and          since the energy of this conformation is lower than the          native a new constraint is generated After complete          minimization of the native conformations if any new          inequalities are generated they are added to the set of          inequalities and a new set of parameters is obtained by          QP If no new inequalities are generated then the          training is complete and a trained potential has been          obtained To keep the number of inequalities within a          manageable limit we periodically discard inequalities          corresponding to nonnatives having energy significantly          higher than the native state ie having high slack          value greater than           S for the current parameter set          Initially           S is set at  and slowly reduced          to                             Authors Contributions        MC designed the fitting protocols wrote the computer        programs chose training and test data and carried out the        calculations GMC contributed overall planning advice        and discussions throughout Both have read and approved the        manuscript            